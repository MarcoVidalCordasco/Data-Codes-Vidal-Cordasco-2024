# Data-Codes-Vidal-Cordasco-Under-Review-2024

This repository hosts the data and code necessary to replicate the models, calculations, and figure generation outlined in the paper by Vidal-Cordasco and Mar√≠n-Arroyo (2024).
1_SpeciesDistributionModel.R: This file contains functions for constructing GLM, GAM, and MAXENT models. A weighted ensemble approach is employed to project the potential distribution of secondary consumers between 50 and 30 kyr BP in Europe. Additionally, this script performs cross-block validation and computes niche breadth indexes. It also includes code for conducting a sensitivity test to evaluate the impact of age uncertainty on outcomes.
2_Z_score&Plots.R: Utilized for calculating the co-occurrence frequency of each secondary consumer species and plotting this information alongside the favorability range obtained from the sensitivity test. This script also generates Hovmoller diagrams depicting habitat favorability for each species.
3_Rarefaction&Co-occurrence.R: Executes a rarefaction analysis to assess species richness in each phase. The code conducts probabilistic co-occurrence modeling for each phase, including a sensitivity test involving 1000 co-occurrence analyses by randomly subsampling and equalizing the number of assemblages per phase. It also generates network plots and bar plots illustrating the association between body mass ratio and co-occurrence frequency among secondary consumers.
4_NicheOverlap&PhylogeneticMixedMode.R: This file provides functions for estimating niche and geographic overlap between each pair of species over a 1,000-year time-step between 55 and 27 kyr BP. It also compares and plots spatial overlap between humans and carnivores during the MIS3. Additionally, the code executes phylogenetic linear mixed models to evaluate whether spatial range, niche overlap, and spatial overlap among secondary consumers significantly impact their co-occurrence frequency, aggregations, and segregations.
As the data and code in this repository are complete, it can be reproduced with only an R environment (tested for R v4.2.0) in RStudio. The necessary package dependencies are documented in each .R file. The content of this repository was made possible thanks to funding from the European Research Council (ERC) under the European Union's Horizon 2020 research and innovation programme (grant agreement No. 818299) for the SUBSILIENCE project (https://www.subsilience.eu/).
